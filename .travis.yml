dist: bionic

language: c

compiler:
    - gcc

addons:
    apt:
        update: true
        packages:
            - build-essential
            - cmake
            - pkgconf
            - wget
            - ca-certificates
            - openssl
            - libssl-dev
            - uuid-dev
            - udev
            - gettext
            - python3
            - python3-pip
            - python3-setuptools
            - python3-wheel
            - ninja-build
            - libconfig-dev
            - libpam0g-dev
            - valgrind

env:
    matrix:
        - BUILD_TYPE=Coverage   CHECK_TARGET=check
        - BUILD_TYPE=Debug      CHECK_TARGET=memcheck
        - BUILD_TPYE=Release    CHECK_TARGET=check
        - BUILD_TYPE=MinSizeRel CHECK_TARGET=check
              

before_install:
    - sudo pip3 install --system meson

before_script:
    - meson build
    - cd build
    - ninja

script:
    - meson test

after_success:
    - bash <(curl -s https://codecov.io/bash)  